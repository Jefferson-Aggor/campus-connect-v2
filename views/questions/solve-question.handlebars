<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campus Connect | Question Solution</title>
    <style>
        .like_dislike {
            cursor: pointer;
            font-weight: 500;
            font-size: 1.3rem;
        }
    </style>
</head>

<body>
    <div class="container">
        {{> _errors}}
        <div class="my-5 ">
            <div class="general-space-between">
                <h4 class="text-dark">{{question.topic}}</h4>
                <p class="text-muted">{{dateFromNow question.askedTime}}</p>
            </div>
            <input type="hidden" value="{{question._id}}" id="questionId">
            <div>
                <p>{{{question.body}}}</p>
                <div class="general-space-between">
                    <button class="btn btn-dark" data-toggle="modal" data-target="#exampleModalScrollable">Add your
                        solution</button>
                    <div>
                        <button class="transparent_btn" id='like'>
                            <i class="far fa-heart like_dislike"></i> <span class="likes-count"></span>
                        </button>
                        <span class="mx-3"></span>
                        <button class="transparent_btn" id="dislike">
                            <i class="far fa-thumbs-down like_dislike"></i>
                            <span class="unlikes-count"></span>
                        </button>

                    </div>
                    <div>
                        {{{showEditMenu loggedUser._id question.user._id question._id}}}
                    </div>

                </div>
                {{> _long-modal}}
            </div>
        </div>


        <div class="solutions container">
            <h4 class="lead">Solutions</h4>
            <div class="divider"></div>
            {{#if question.solutions}}
            {{#each question.solutions}}
            <div class="card p-2 mb-2 bg-light">

                <div class="general-space-between">
                    <div class="general-display-flex my-2">
                        <span class="nameStripper mx-1">
                            {{nameStripper solvedBy.firstname}}
                        </span>
                        <span>
                            <a href="/chat-room/userprofile/{{solvedBy._id}}" class="text-dark">
                                {{solvedBy.firstname}} {{solvedBy.lastname}}
                            </a>
                        </span>
                    </div>
                    <small>{{formatDate solvedDate}}</small>
                </div>
                {{#if file}}
                <div class="container-sm">
                    <a href="{{file}}"><img src="{{file}}" alt="" style="max-height: 300px;"></a>
                </div>
                {{else}}
                <div class="container">
                    <p class="mx-5">{{{solution}}}</p>
                </div>

                {{/if}}
                <div class="mx-5">
                    <div class="general-space-between my-2">
                        <div class="general-display-flex ">
                            <a href=""><i class="fas fa-globe mx-2"></i></a>
                            <a href=""><i class="fas fa-user"></i></a>
                        </div>
                        <a href="#">...</a>

                    </div>
                </div>
            </div>
            {{/each}}

            {{else}}
            <p>No solution yet </p>
            {{/if}}
        </div>


    </div>

    <script>
        const likeIcon = document.getElementById('like');
        const dislikeIcon = document.getElementById('dislike')
        const likesCount = document.querySelector('.likes-count')
        const unlikesCount = document.querySelector('.unlikes-count')
        const questionId = document.getElementById('questionId')

        likeIcon.addEventListener('click', function () {
            const questionID = questionId.value;

            const xhr = new XMLHttpRequest();
            xhr.open('post', `/like-question/${questionID}`, true)
            xhr.setRequestHeader('Content-Type : x-www-form-urlencoded')
            xhr.onreadystatechange = function () {
                console.log(this.readyState)
            }

            xhr.send(`questionId : ${questionID}`)
        })
    </script>

</body>

</html>